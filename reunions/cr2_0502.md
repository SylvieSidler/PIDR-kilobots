# Réunion n°2 du 5 février

## Accès au compte sur l'ordinateur
utilisateur : `pidr kilobots`
mot de passe : `telecom`

## Installation des différentes librairies

`repertoirePIDR`le nom du répertoire "souche" où on installe le tout.

### #1. Installer Kilolib
- cloner le git kilolib par acornejo : https://github.com/acornejo/kilolib

`git clone git@github.com:acornejo/kilolib.git`

- installer `gcc-avr` et `avr-libc`


> **Windows**
> `sudo apt install gcc-avr`

> **MacOS**
> `brew tap osx-cross/avr`
> `brew install avr-gcc`

- se déplacer dans le rep kilolib `cd kilolib`
- utiliser le makefile : `make` 
- sortir du repertoire git et créer 2 directories lib et include : 
```shell
cd .. 
mkdir lib include
```

- copier `build/kilolib.a`, `kilolib.h` et `message.h` du répertoire `kilolib/` créé par le make dans les nouveaux répertoires : 
```shell
cp kilolib/build/kilolib.a lib
cp kilolib/kilolib.h include
cp kilolib/message.h include
cp kilolib/message_crc.h include
```
Pour avoir la documentation de Kilolib :
```shell
brew install doxygen
make docs
cd docs/html
open index.html
```

### #2. Installer Kilombo
- cloner le git kilombo par JIC-CSB : https://github.com/JIC-CSB/kilombo
```shell
git clone git@github.com:JIC-CSB/kilombo.git 
cd kilombo
```

- installer les dépendances selon le README :

> **Windows** : 
> ```
> sudo apt-get install build-essential git gcc-avr gdb-avr binutils-avr avr-libc avrdude libsdl1.2-dev libjansson-dev libsubunit-dev cmake check
> ``` 

> **MacOS** :
> ```
> brew install cmake 
> brew install check
> brew install sdl
> brew install jansson
> ```
>
> & ajouter les lignes suivante à `~/.bash_profile`
> ```
> export C_INCLUDE_PATH=/usr/local/include/:$C_INCLUDE_PATH 
> export LIBRARY_PATH=/usr/local/lib:$LIBRARY_PATH
> ```

- instructions pour compiler (peuvent différer du readme kilombo) : 
```shell
mkdir build && cd build
cmake -DCMAKE_INSTALL_PREFIX=/kilombo ..
make DESTDIR=~/chemin/vers/repertoirePIDR install
```
> **MacOS** :
> ajouter les lignes suivantes au fichier `CMakeLists.txt` :
>```
> include_directories(/opt/homebrew/include/)
> link_directories(/opt/homebrew/lib/)
> ```
> 
> trop d'erreurs -> suite plus tard

- retour au repertoire et copie des include et lib dans les répertoires `include` et `lib` créés
```shell
cd ../../include
cp -a ../kilombo/include/kilombo .
cd lib/
cp ../kilombo/libsim.a .
cp ../kilombo/libheadless.a .
cd ..
```

### #3. Installer KiloGUI
- cloner le repo git https://github.com/acornejo/kilogui
```shell
git clone git@github.com:acornejo/kilogui.git
cd kilogui
```
- modifier le fichier `src/src.pro` : 
    - modifier la ligne 22 : `PREFIX = /chemin/vers/repertoirePIDR`
    - ajouter  la ligne `QT += widgets` au début
- patch des fichiers source : modifier `#include <QtGui>` en `#include <QtWidgets>` dans les fchiers suivants 
    - `src/calibrate.cpp` 
    - `src/kilowindow.cpp` 
    - `src/serialwin.cpp`

- installer `qmake` et `libftdi-dev`
> **Windows**
> `sudo apt install qt5-qmake`
> `sudo apt install libftdi-dev`

> **MacOS** 
> `brew install qt`
> `brew install libftdi`
- executer `qmake kilogui.pro` 
> si l'erreur `qmake: could not find a Qt installation of''` apparait, utiliser 
> `qmake -qt=qt5 kilogui.pro`
- puis `make`
> si l'erreur `Unknown module(s) in QT: core gui widgets.` apparait, lancer 
> `sudo apt install qtbase5-dev` 

